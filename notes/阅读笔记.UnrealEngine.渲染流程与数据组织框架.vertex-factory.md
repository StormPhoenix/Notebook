---
id: qoifni239nr9qowj0mwy4vt
title: Vertex Factory
desc: ''
updated: 1689095597540
created: 1689067138535
---

作用：
- 绑定 Shader 
- 绑定顶点数据 VertexBuffer 
- 其他需要绑定数据

## Vertex Buffer & Vertex Declaration
FVertexStreamComponent: 定义顶点格式，GPU 侧需要这个来确定如何读取顶点数据。
FRHIShaderResourceView: 保存实际的顶点数据。

以上由 FLocalVertexFactory::FDataType (或者其子类) 封装。

## Mesh 与 Vertex Buffer
示例：RenderData->VertexBuffer

https://zhuanlan.zhihu.com/p/128656015

IMPLEMENT_VERTEX_FACTORY_TYPE

FVertexStream <.. FVertexBuffer

FPrimitiveSceneProxy  
    <.. UMaterialInterface
    <.. FXXXVertexFactory

FVertexFactory 里的顶点数据输入和 HLSL 绑定：IMPLEMENT_VERTEX_FACTORY_TYPE
    绑定 LocalVertexFactory.usf，该 usf 是 UberShader，真正运行时的顶点输入需要靠宏开关定义。宏开关由 FVertexFactory 

IMPLEMENT_MATERIAL_SHADER_TYPE 绑定的是 C++ Shader 和 HLSL 中的参数
IMPLEMENT_VERTEX_FACTORY_TYPE 绑定的是 C++ VertexFactory 和 HLSL 中的顶点数据

VertexFactory主要负责将特定网格类型的顶点从CPU传递到GPU，然后在VertexShader中使用，它描述了UE的各个渲染Pass输入给Shader的顶点数据都是什么

这篇文章讲了 VertexFactory 涉及到的几个核心类
https://zhuanlan.zhihu.com/p/344573382

https://zhuanlan.zhihu.com/p/361322348